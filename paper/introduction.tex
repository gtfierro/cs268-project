\section{Introduction}

It has been several years since RPL was introduced as a routing protocol for the kinds of links used in wireless sensor networks (WSNs).
While various commercial products have introduced some form of IPv6 over LoWPAN, these operate in stand-alone settings, such as automated meter reading networks, and there is essentially nothing in the literature regarding specifics or performance of their routing protocols.
Open implementations of RPL are available, but there is a pronounced lack of study of their empirical behavior, particularly in the common case of small (10s of nodes) shallow (one to three hop) networks.

Wireless sensor networks are characterized by low bandwidth, low power, limited storage and computational power, and short range (10-50 meters).
These networks must be self-configuring in that nodes must discover and construct their own topology rather than receiving a global view of a network and constructing provably optimal routes.
Topology formation defines the set of upwards (multipoint-to-point), downwards (point-to-multipoint) and point-to-point routes application traffic can take through the network.
This must be done with mind to the channel utilization.
More control traffic sent to form or discover or maintain a topology, restricts the lifetime and size of a network as well as bandwidth available for application traffic, which is typically sent at low rates (e.g. one packet per minute).

The original vision of this project was to develop a new routing protocol --- \texttt{3hop} --- for this common but understated scenario and to augment a discussion of the design and implementation of this new protocol with a comparative study of RPL.
However, upon embarking on this task, we found that there does not exist adequate instrumentation for studying the low-level behavior of nodes in a real-world sensor mesh.
To this end, we leverage recent advances in embedded programming environments~\ref{andersen2016system} using dynamic languages to construct a flexible platform for providing rich introspection into the behavior of a networking stack during topology formation.
We augment this ability with an Active Networks-like approach. 
Executable code capsules disseminated through a network define network experiment parameters, which telemetry to gather and how often and the start and stop conditions for each experiment.
We also demonstrate the ability to switch between routing protocol implementations on an embedded platform \emph{without the need for reprogramming}.

We provide three takeaways in this paper.
Firstly, we provide an analysis and criticism of the RPL and IPv6 Neighbor Discovery standards discussing how their current definition can be considered overly complex and detrimental for the domain of wireless sensor networks.
Secondly, we present the implementation of the network measurement platform we found necessary to construct reasonable studies of the routing protocols at hand.
Lastly, we present the design of an alternative routing protocol --- 3hop --- intended for small-diameter WSNs.
3hop takes advantage of the broadcast medium to share information between nodes to better detect when control traffic is redundant in order to quiesce appropriately.
Although the development of the routing protocol is not complete --- for instance, we have not yet implemented it in duty-cycled networks --- the initial results demonstrate that this design direction is a promising avenue.

\if 0
- Motivation starts off by saying: look, for the very common case of indoor, low-power
  sensor networks, there is a need for routing.
- what do WSN nodes look like?
    - http://www.airccse.org/journal/ijcses/papers/1110ijcses06.pdf
    - low bandwidth, low power, low memory, short range (10-50m)
    - unreliable -- things crash, run out of power -> topology changes!
      - need to adapt to failures
    - self-configuring: nodes will need to discover the topology.
    - channel utilization:
      - want to make efficient use of bandwidth by reducing control traffic
        necessary for maintaining the mesh
      - has upshot of saving power too
      - this is also addressed at MAC layer, which we do not address
- This particular case of WSN topology formation is defined by the following characteristics:
    - SMALL: order 10s of nodes, over a small geographic area: a building or collection of rooms
    - mains power available at some locations throughout a space: wall plugs here and there
    - It is feasible to cover the monitored space in a mesh with hops no greater than 3
    - environment can change: furniture, people -- transient connectivity
- establish the goals and parameters of our proposed routing protocol
- Firstly, what does a routing protocol have to do?
    - mote must discover the prefix
      - simplifying assumptions: slaac, using 48-bit MAC and 16 bit node id
    - build upward routes: multipoint-to-point
      - list some ways to do this?
    - build downward routes
      - need for acknowledgements, actuations
    - point to point routes
      - rarer, but in small networks w/ actuators and sensors, this may become more common.
    - prepare for failure:
      - provide a means of repairing the network
    - useful parts: border router, providing physical translation in/out of
      the network. Handles prefix compression/expansion for 6lowpan, generally
      more powerful, powered. Can have large bandwidth backbone
\fi

